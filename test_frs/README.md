# 温度变送器型号字符串生成逻辑

## 概述
温度变送器型号字符串是由主型号和一系列规格代码组成的标识符，用于精确描述产品配置。

**示例**：YTA610-JA1C2NN/NF2

## 基本原则
- **标准参数**：对应CSV文件中的"model"列参数
- **标准参数值/缺省默认值**：对应CSV文件中的"code"列参数

## 一、核心处理逻辑

### 1. 输入参数解析
- **结构化输入**：接收{标准参数: 标准参数值/缺省默认值}格式的参数映射
- **扩展参数支持**：处理{实际参数值/说明/备注}等非标准输入形式，【这里暂时不做】

### 2. 产品主型号确定
- 通过{温度变送器: VALUE}查询index.json文件，VALUE必须精确匹配index.json中的产品主型号（键）
- 根据确定的主型号，定位关联的CSV数据源文件（可能有多个）

## 二、参数匹配与规格代码生成流程

### 1. 标准参数匹配阶段
- 遍历输入的"标准参数"集合
- 采用多种匹配策略将输入参数与CSV中"model"列参数进行对应匹配，其中每个标准参数可能对应CSV文件中多行同名的"model"参数（即一个标准参数可能匹配到多行记录，但这些记录的model名称相同）。匹配策略按以下优先级顺序执行：
  1. 精确匹配
  2. 模糊匹配（语义向量）
  3. 大模型智能检索
- 系统将首先尝试高优先级的匹配策略。若当前策略完全匹配失败或被中断，则放弃该策略，切换至下一优先级策略继续尝试。当某策略匹配成功，即筛选出匹配的若干行；若所有策略均失败，则系统报错并退出。为保证代码结构清晰，这两种匹配策略应分别实现为独立函数。
- 标准参数应该被完全匹配完毕。若标准参数匹配完毕，但CSV中仍有剩余“model”参数未被匹配，则报错：f"错误: {model_i}未被匹配，请返回语义库步骤补充输入并按缺省默认值提交，否则无法继续。"

### 2. 规格代码匹配规则
- 承接上一步骤，在"标准参数"已与"model"列的参数完成匹配后，需将这些"标准参数"对应的值（即"标准参数值/缺省默认值"）与CSV文件中相应model的多行记录中的"description"和"remark"列进行多策略匹配。这一过程旨在精确定位唯一匹配行。匹配策略按以下优先级执行：
  1. 模糊匹配（语义向量）
  2. 大模型智能检索
- 系统将首先尝试高优先级的匹配策略。若当前策略匹配失败或被中断，则放弃该策略，切换至下一优先级策略继续尝试。一旦某策略匹配成功，即筛选出的目标行；若所有策略均失败，则系统报错并退出。为保证代码结构清晰，这两种匹配策略应分别实现为独立函数。
- 当成功找到唯一匹配行后，该行对应的"code"值即为当前"标准参数"所对应的"规格代码"，将用于后续型号字符串的组装。

### 3. 规格代码占位格式
按照CSV里model列的参数排列，按自上而下的顺序逐个生成。每个同名参数占一个{规格代码i}位。详细格式：
```
{主型号}{规格代码1}{规格代码2}...{规格代码N}
```
例如：YTA710-JA1C2NN/NF2，其中YTA710为主型号，后续字符为各项同名参数对应的规格代码的组合。

### 4. 规格代码输出
- 按照产品规格定义的顺序，依次组装已确定的规格代码
- 用大模型根据传入的标准参数值，结合型号字符串中对应的"description"和"remark"列的值，编写推荐原因。
- 一并输出最终完整的型号字符串以及推荐原因。
- 这一步骤需要不断完善提示词。